{
    # Global options
    admin off
    auto_https disable_redirects
    servers {
        protocols h1 h2
    }
}

# Ollama API endpoint
llm.jerryagenyi.xyz {
    # Basic authentication
    basicauth {
        # Replace {YOUR_HASH} with the output of `caddy hash-password`
        admin {YOUR_HASH}
    }

    # Reverse proxy to Ollama running on Windows host
    reverse_proxy host.docker.internal:11434 {
        # Add headers to prevent bot detection
        header_up X-Forwarded-For {remote_host}
        header_up X-Real-IP {remote_host}
        header_up User-Agent "Ollama-Client/1.0"
        
        # Basic rate limiting
        rate_limit {
            zone ollama
            rate 10r/s
            burst 20
        }
    }

    # Logging
    log {
        output file /data/ollama.log
        format json
    }
}

# N8N instance
n8n.jerryagenyi.xyz {
    # Basic authentication
    basicauth {
        # Replace {YOUR_HASH} with the output of `caddy hash-password`
        admin {YOUR_HASH}
    }

    # Reverse proxy to N8N container
    reverse_proxy n8n:5678 {
        # Add headers to prevent bot detection
        header_up X-Forwarded-For {remote_host}
        header_up X-Real-IP {remote_host}
        header_up User-Agent "N8N-Client/1.0"
        
        # Basic rate limiting
        rate_limit {
            zone n8n
            rate 5r/s
            burst 10
        }
    }

    # Logging
    log {
        output file /data/n8n.log
        format json
    }
}

# Flowise instance
flowise.jerryagenyi.xyz {
    # Basic authentication
    basicauth {
        # Replace {YOUR_HASH} with the output of `caddy hash-password`
        admin {YOUR_HASH}
    }

    # Reverse proxy to Flowise container
    reverse_proxy flowise:3000 {
        # Add headers to prevent bot detection
        header_up X-Forwarded-For {remote_host}
        header_up X-Real-IP {remote_host}
        header_up User-Agent "Flowise-Client/1.0"
        
        # Basic rate limiting
        rate_limit {
            zone flowise
            rate 5r/s
            burst 10
        }
    }

    # Logging
    log {
        output file /data/flowise.log
        format json
    }
} 